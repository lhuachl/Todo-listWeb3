@page
@model LoginModel
@{
    ViewData["Title"] = "Login - Seleccionar Usuario";
}

<div class="main-content" style="margin-left: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh;">
    <div class="glass-card" style="max-width: 500px; width: 100%;">
        <h1 class="form-title">?? Todo App - Multiusuario</h1>
        
        @if (!ModelState.IsValid)
        {
            <div style="color: #e53935; text-align: center; margin-bottom: 20px;">
                @foreach (var error in ModelState.Values.SelectMany(v => v.Errors))
                {
                    <div>@error.ErrorMessage</div>
                }
            </div>
        }

        <!-- Formulario para crear nuevo usuario o hacer login -->
        <form method="post">
            <div class="form-group">
                <input asp-for="Username" placeholder="Nombre de usuario" required class="glass-input" />
            </div>
            
            <div style="display: flex; gap: 12px; justify-content: center; margin: 20px 0;">
                <button type="submit" asp-page-handler="Login" class="glass-btn primary">
                    ?? Iniciar Sesión
                </button>
                <button type="submit" asp-page-handler="CreateUser" class="glass-btn">
                    ?? Crear Usuario
                </button>
            </div>
        </form>

        <!-- Lista de usuarios existentes -->
        @if (Model.Users.Any())
        {
            <hr style="margin: 30px 0; border: none; height: 1px; background: #353b45;" />
            <h3 style="color: #e5e9f2; text-align: center; margin-bottom: 20px;">
                O selecciona un usuario existente:
            </h3>
            
            <div style="display: grid; gap: 10px; max-height: 300px; overflow-y: auto;">
                @foreach (var user in Model.Users)
                {
                    <form method="post" style="margin: 0;">
                        <input type="hidden" name="userId" value="@user.Id" />
                        <button type="submit" asp-page-handler="SelectUser" 
                                class="glass-btn" 
                                style="width: 100%; text-align: left; padding: 12px 20px;">
                            ?? @user.Username
                        </button>
                    </form>
                }
            </div>
        }
        
        <div style="text-align: center; margin-top: 30px; color: #7a869a; font-size: 0.9rem;">
            ?? Si eres nuevo, crea un usuario. Si ya tienes uno, inicia sesión o selecciónalo de la lista.
        </div>
    </div>
</div>